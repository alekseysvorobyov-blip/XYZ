№,Категория,Показатель качества,Объект мониторинга
1.1,Мониторинг доступности компонента,Количество активных подключений к БД,"PostgreSQL Database (норма: <300, предупреждение: 300-400, критично: >400)"
1.2,Мониторинг доступности компонента,Размер базы данных на диске,"PostgreSQL Database (рост ~100 GB/месяц, критично: >90% диска)"
1.3,Мониторинг доступности компонента,Количество активных consumer в группе,"Kafka Consumer Group (норма: 1, критично: 0 - consumer остановлен)"
1.4,Мониторинг доступности компонента,Доступность Kafka топиков,"Apache Kafka (топики: upoa_enriched_transactions, upoa_ksk_results)"
1.5,Мониторинг доступности компонента,Доступность KSK Consumer Service,KSK Consumer Application (Java/Spring Boot)
2.1,Основные показатели компонента,Скорость транзакций в секунду (TPS),"PostgreSQL Database (норма: 30-50 TPS, критично: <10 или >1000 TPS)"
2.2,Основные показатели компонента,Cache Hit Ratio (эффективность кеша),"PostgreSQL Database (норма: >99%, предупреждение: 95-99%, критично: <95%)"
2.3,Основные показатели компонента,Раздутие таблиц (Bloat %),"PostgreSQL Tables (норма: 0-10%, предупреждение: 10-30%, критично: >30%)"
2.4,Основные показатели компонента,Использование индексов (Index Scan %),"PostgreSQL Tables (оптимально: >90%, критично: <50%)"
2.5,Основные показатели компонента,Kafka Consumer Lag (отставание),"Kafka Consumer Group (норма: <100K, предупреждение: 100K-200K, критично: >200K)"
2.6,Основные показатели компонента,Скорость поступления сообщений в Kafka,"Kafka Topics (норма: <1300 msg/sec, предупреждение: 1300-1500, критично: >1500)"
2.7,Основные показатели компонента,Количество блокировок (Locks),"PostgreSQL Database (норма: 0-5, требует проверки: >50)"
2.8,Основные показатели компонента,Checkpoints соотношение,PostgreSQL bgwriter (норма: checkpoints_req <10% от checkpoints_timed)
2.9,Основные показатели компонента,Database Age (transaction ID wraparound),"PostgreSQL Database (норма: <1B, предупреждение: 1-1.5B, критично: >1.5B)"
2.10,Основные показатели компонента,Использование временных файлов,PostgreSQL Database (мониторинг роста temp_bytes)
2.11,Основные показатели компонента,Deadlocks (взаимные блокировки),PostgreSQL Database (критично: >0)
2.12,Основные показатели компонента,Autovacuum активность,"PostgreSQL Tables (мониторинг last_autovacuum, vacuum_count)"
3.1,Прикладной мониторинг,Скорость обработки сообщений Consumer,"KSK Consumer (норма: 30-50 msg/sec, критично: <10 msg/sec)"
3.2,Прикладной мониторинг,Join Success Rate (% успешных join по corrId),"KSK Consumer (норма: >98%, предупреждение: 95-98%, критично: <95%)"
3.3,Прикладной мониторинг,Join Delay Average (задержка join пары сообщений),"KSK Consumer (норма: <2 sec, предупреждение: 2-10 sec, критично: >10 sec)"
3.4,Прикладной мониторинг,Время записи в БД (Database Write Duration p95),"KSK Consumer → PostgreSQL (норма: <100ms, предупреждение: 100-200ms, критично: >200ms)"
3.5,Прикладной мониторинг,Ошибки записи в БД (Database Write Errors),"KSK Consumer → PostgreSQL (норма: 0%, критично: >1%)"
3.6,Прикладной мониторинг,Orphan Messages (сообщения без пары >5 минут),"KSK Consumer (норма: 0-10, предупреждение: 10-100, критично: >100)"
3.7,Прикладной мониторинг,Успешность формирования отчётов,Report Orchestrator (мониторинг статусов: done/error в ksk_report_header)
3.8,Прикладной мониторинг,Время формирования отчётов,"Report Functions (Totals: <5 мин, Figurants: <15 мин)"
3.9,Прикладной мониторинг,Успешность выполнения автоматических задач,"pg_cron Jobs (create_partitions, cleanup, drop_old_partitions)"
3.10,Прикладной мониторинг,Количество записей в системном логе операций,ksk_system_operation_log (мониторинг статусов success/error)
3.11,Прикладной мониторинг,Корректность партиционирования,PostgreSQL Partitions (проверка создания партиций на 7 дней вперёд)
3.12,Прикладной мониторинг,Актуальность удаления старых данных,Retention Policy (проверка удаления партиций старше 365 дней)
